import{s as _}from"./index-bYg977Vk.js";import{n as F,_ as w,m as c,a as p,c as i,f as m,b as s,t as n,i as a,g as h,k as g,l as f,p as C,j as D,F as L,r as j,u as v,h as S,o as r,d as V}from"./index-C2ccw7wI.js";import{g as B,u as x}from"./products-B9qwIn9Z.js";import{P as N}from"./ProductCard-DpKaHt_5.js";import"./request-a1iyVawE.js";const P=F("product",{state:()=>({pending:!0,product:null}),actions:{async getData(e){this.pending=!0;try{const t=await B(e);this.product=t.data||t}catch(t){console.error(`Failed to fetch product ${e}:`,t),this.product=null}finally{this.pending=!1}}}}),A={components:{ProgressSpinner:_,Product:N},data(){return{displayProduct:null,isFavoriteLocal:!1}},computed:{...p(P,["product","pending"]),...p(v,{favoriteItems:"products"}),...p(x,{allProducts:"products"}),similarProducts(){return!this.product||!this.allProducts||this.allProducts.length===0?[]:this.allProducts.filter(e=>e.animal===this.product.animal&&e.id!==this.product.id).slice(0,4)}},watch:{product(){this.updateDisplayProduct()},favoriteItems(){this.updateDisplayProduct()},"displayProduct.isFavorite"(e){this.isFavoriteLocal=e}},methods:{...c(P,["getData"]),...c(S,["addProduct"]),...c(v,["toggleFavorite"]),...c(x,{fetchAllProducts:"getData"}),updateDisplayProduct(){if(!this.product){this.displayProduct=null;return}const e=!!this.favoriteItems.find(t=>t.id===this.product.id);this.displayProduct={...this.product,isFavorite:e},this.isFavoriteLocal=e},handleFavoriteClick(){this.isFavoriteLocal=!this.isFavoriteLocal,this.toggleFavorite(this.displayProduct)}},created(){this.getData(this.$route.params.id),this.fetchAllProducts()}},I={class:"w-full"},z={key:0,class:"grid grid-cols-1 gap-8 md:grid-cols-2 md:gap-12"},E={class:"w-full"},M=["src"],T={class:"flex flex-col justify-center gap-4"},q={class:"text-3xl font-bold text-slate-900 md:text-4xl"},G={key:0,class:"flex items-center gap-2"},H={class:"font-semibold text-slate-600"},J={class:"my-2 text-4xl font-extrabold text-slate-900"},K={class:"flex flex-col items-stretch gap-3 sm:flex-row"},O={class:"mt-6"},Q={class:"mt-2 leading-relaxed text-slate-600"},R={key:1,class:"flex h-96 items-center justify-center"},U={key:2,class:"py-16 text-center text-slate-500"},W={key:3,class:"mt-16 w-full lg:mt-24"},X={class:"grid grid-cols-2 gap-4 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4"};function Y(e,t,Z,$,o,d){const u=h("vue-feather"),y=_,b=h("router-link"),k=h("Product");return r(),i("div",I,[o.displayProduct?(r(),i("div",z,[s("div",E,[s("img",{src:o.displayProduct.image,alt:"Product image",class:"h-auto w-full rounded-lg object-cover shadow-md"},null,8,M)]),s("div",T,[s("h1",q,n(o.displayProduct.title),1),o.displayProduct.rating?(r(),i("div",G,[a(u,{type:"star",class:"h-5 w-5 fill-orange-400 stroke-orange-400"}),s("span",H,n(o.displayProduct.rating),1)])):m("",!0),s("div",J,n(o.displayProduct.price)+" ₽",1),s("div",K,[s("button",{onClick:t[0]||(t[0]=g(l=>e.addProduct(o.displayProduct),["prevent"])),class:"flex flex-grow items-center justify-center gap-3 rounded-lg bg-purple-600 px-6 py-3 font-bold text-white transition hover:bg-purple-700"},[a(u,{type:"shopping-cart",class:"h-5 w-5"}),t[2]||(t[2]=f(" Добавить в корзину ",-1))]),s("button",{onClick:t[1]||(t[1]=g((...l)=>d.handleFavoriteClick&&d.handleFavoriteClick(...l),["prevent"])),class:C(["flex items-center justify-center rounded-lg border p-3 transition",o.isFavoriteLocal?"border-red-500 bg-red-50 text-red-600":"border-slate-300 text-slate-500 hover:bg-slate-100"]),"aria-label":"Добавить в избранное"},[a(u,{type:"heart",fill:o.isFavoriteLocal?"currentColor":"none",class:"h-5 w-5"},null,8,["fill"])],2)]),s("div",O,[t[3]||(t[3]=s("h2",{class:"text-lg font-semibold text-slate-900"},"Описание",-1)),s("p",Q,n(o.displayProduct.description),1)])])])):e.pending?(r(),i("div",R,[a(y)])):(r(),i("div",U,[t[5]||(t[5]=s("h2",{class:"text-xl font-semibold"},"Товар не найден",-1)),a(b,{to:"/",class:"mt-4 inline-block text-purple-600 hover:underline"},{default:D(()=>t[4]||(t[4]=[f(" Вернуться в каталог ",-1)])),_:1,__:[4]})])),d.similarProducts.length>0?(r(),i("div",W,[t[6]||(t[6]=s("h2",{class:"mb-6 text-2xl font-bold text-slate-900"},"Похожие товары",-1)),s("div",X,[(r(!0),i(L,null,j(d.similarProducts,l=>(r(),V(k,{key:l.id,item:l},null,8,["item"]))),128))])])):m("",!0)])}const it=w(A,[["render",Y]]);export{it as default};
